<!DOCTYPE html>
<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />

  <script type="module">
    import init, { do_thing, start_thing } from './pkg/wasm_unknown.js';

    export async function run() {
      let output = await init();
      window["HEAPF32"] = {
        cached: null,
        getCachedMemory() {
          if (this.cached === null || this.cached.buffer.detached === true || (this.cached.buffer.detached === undefined && this.cached !== output.memory.buffer)) {
            this.cached = new Float32Array(output.memory);
          }
          return this.cached;
        },
        subarray(...args) {
          return this.getCachedMemory().subarray(...args);
        }
      };
      do_thing();
    }

    run();

    document.querySelector("#the_button").addEventListener("click", (event) => {
      start_thing();
    })
  </script>
</head>

<body>

</body>

<button id="the_button">fsdfafsfasd</button>

</html>